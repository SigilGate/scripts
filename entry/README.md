# Операции с Entry-нодами

Атомарные скрипты для управления клиентами в Xray на Entry-нодах **Sigil Gate**.

Все операции выполняются по SSH с sudo. Каждый скрипт работает с одной Entry-нодой и одним UUID.

## Скрипты

### `add-client.sh` [атомарный]

Добавление клиента (UUID) в конфигурацию Xray на Entry-ноде.

```bash
./entry/add-client.sh --host <IP> --uuid <UUID> --service-name <SERVICE_NAME> --name <LABEL>
```

Последовательность:
1. Резервное копирование конфигурации Xray
2. Добавление UUID в массив клиентов (jq)
3. Валидация конфигурации (`xray run -test`)
4. Перезапуск Xray
5. Проверка статуса

Откат при ошибке валидации. Идемпотентно: exit 0 если UUID уже существует.

### `remove-client.sh` [атомарный]

Удаление клиента (UUID) из конфигурации Xray на Entry-ноде.

```bash
./entry/remove-client.sh --host <IP> --uuid <UUID> --service-name <SERVICE_NAME>
```

Аналогичная последовательность, но вместо добавления — фильтрация UUID из массива клиентов. Идемпотентно: exit 0 если UUID не найден.
